(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{372:function(e,t,n){"use strict";n(75)},414:function(e,t,n){var o=n(562);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(49)(o,r);o.locals&&(e.exports=o.locals)},562:function(e,t,n){(e.exports=n(48)(!1)).push([e.i,".post {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  padding: 1em;\n  -webkit-box-shadow: 0px 0px 0.5em #535353;\n          box-shadow: 0px 0px 0.5em #535353;\n  background-color: #fff;\n  border-radius: 0.5em;\n  margin: 0 0 1em; }\n  .post .avatar {\n    cursor: pointer; }\n  .post > div:nth-child(1) {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex; }\n    .post > div:nth-child(1) > div:nth-child(2) {\n      margin-left: 1em;\n      -webkit-box-flex: 1;\n          -ms-flex: 1;\n              flex: 1;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-orient: vertical;\n      -webkit-box-direction: normal;\n          -ms-flex-direction: column;\n              flex-direction: column; }\n      .post > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) {\n        cursor: pointer; }\n        .post > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > span {\n          font-size: 1.2em;\n          font-weight: bold; }\n      .post > div:nth-child(1) > div:nth-child(2) > div:nth-child(1):hover {\n        background-color: #EAEAEF; }\n      .post > div:nth-child(1) > div:nth-child(2) > div:nth-child(2) {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-pack: justify;\n            -ms-flex-pack: justify;\n                justify-content: space-between;\n        color: #363636; }\n  .post > div:nth-child(2) {\n    border-top: #b1abab solid 1px;\n    border-bottom: #b1abab solid 1px;\n    margin: 1em 0;\n    padding: 1em 0; }\n  .post > div:nth-child(3) {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: justify;\n        -ms-flex-pack: justify;\n            justify-content: space-between; }\n    .post > div:nth-child(3) > div:nth-child(1) {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center; }\n      .post > div:nth-child(3) > div:nth-child(1) i {\n        font-size: 1.5em; }\n      .post > div:nth-child(3) > div:nth-child(1) > span {\n        margin: 0 0.5em; }\n\n.comments {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  padding: 1em;\n  -webkit-box-shadow: 0px 0px 0.5em #535353;\n          box-shadow: 0px 0px 0.5em #535353;\n  background-color: #fff;\n  border-radius: 0.5em;\n  padding: 1em;\n  margin: 0 0 1em; }\n\n.comment-editor {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n\n.comment {\n  border-left: #b1abab solid 1px;\n  padding-left: 1em;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  margin-top: 1em; }\n  .comment > div:nth-child(1) {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    cursor: pointer; }\n    .comment > div:nth-child(1) :nth-child(2) {\n      margin-left: 0.5em; }\n  .comment > div:nth-child(1):hover {\n    background-color: #EAEAEF; }\n  .comment > div:nth-child(2) {\n    padding: 0.5em 0; }\n  .comment > div:nth-child(3) {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: justify;\n        -ms-flex-pack: justify;\n            justify-content: space-between;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center; }\n    .comment > div:nth-child(3) button {\n      border: 1px solid #aaa;\n      background-color: #fff;\n      font-size: 0.5em;\n      cursor: pointer; }\n",""])},697:function(e,t,n){"use strict";n.r(t);n(241);var o=n(77),r=(n(372),n(78)),i=(n(356),n(357)),l=(n(240),n(76)),c=n(361),a=n(380),s=n(385),u=n(3),p=n(15),f=n(0),d=n.n(f),m=n(1),h=n.n(m),b=n(6),y=(n(355),n(360)),v=(n(366),n(378));n(414);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var w,g=(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),k=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":x(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;0<=c;c--)(r=e[c])&&(l=(i<3?r(l):3<i?r(t,n,l):r(t,n))||l);return 3<i&&l&&Object.defineProperty(t,n,l),l},E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content="",e}return g(e,t),e.prototype.render=function(){var t=this;return h.a.createElement("div",{className:"comment-editor",style:this.props.style},h.a.createElement(v.a,{placeholder:"评论...",style:{flex:1,marginRight:"0.5em"},onChange:function(e){return t.content=e.target.value,t.editor=e.target}}),h.a.createElement(y.a,{type:"primary",onClick:function(){return t.props.onComment(t.content,t.editor)},disabled:""===this.content.trim()},"评论"))},k([u.m],e.prototype,"content",void 0),e=k([p.c],e)}(h.a.Component);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j,O=(j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":C(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;0<=c;c--)(r=e[c])&&(l=(i<3?r(l):3<i?r(t,n,l):r(t,n))||l);return 3<i&&l&&Object.defineProperty(t,n,l),l},S=function(i,l,c,a){return new(c||(c=Promise))(function(e,t){function n(e){try{r(a.next(e))}catch(e){t(e)}}function o(e){try{r(a.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(n,o)}r((a=a.apply(i,l||[])).next())})},P=function(n,o){var r,i,l,e,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(l=2&t[0]?i.return:t[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,t[1])).done)return l;switch(i=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(l=0<(l=c.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){c.label=t[1];break}if(6===t[0]&&c.label<l[1]){c.label=l[1],l=t;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(t);break}l[2]&&c.ops.pop(),c.trys.pop();continue}t=o.call(n,c)}catch(e){t=[6,e],i=0}finally{r=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};d.a.locale("zh-cn");var R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openEditor=!1,e.onComment=function(o,r){return S(e,void 0,void 0,function(){var t,n;return P(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,a.a.add(o,this.props.comment.postId,this.props.store.me,(new Date).getTime(),this.props.comment.id)];case 1:return t=e.sent(),this.props.comment.children.push(t),r.value="",[3,3];case 2:return n=e.sent(),console.error(n),l.a.error(n),[3,3];case 3:return[2]}})})},e}var n;return O(e,t),(n=e).prototype.render=function(){var e=this;return h.a.createElement("div",{className:"comment"},h.a.createElement("div",{onClick:function(){return b.Control.go("/user/"+e.props.comment.accountId)}},h.a.createElement("div",null,h.a.createElement(i.a,{src:this.props.comment.avatar,size:"small",shape:"square"})),h.a.createElement("div",null,h.a.createElement("span",null,this.props.comment.username))),h.a.createElement("div",null,h.a.createElement("p",null,this.props.comment.content)),h.a.createElement("div",null,h.a.createElement("div",null,h.a.createElement("button",{onClick:function(){return e.openEditor=!e.openEditor}},"评论")),h.a.createElement("div",null,h.a.createElement("span",null,d()(this.props.comment.createAt).format("YYYY-MM-DD HH:mm")))),this.openEditor?h.a.createElement(E,{onComment:this.onComment,style:{marginTop:"0.5em"}}):null,this.props.comment.children.map(function(e){return h.a.createElement(n,{comment:e,key:e.id})}))},_([u.m],e.prototype,"openEditor",void 0),e=n=_([Object(p.b)("store"),p.c],e)}(h.a.Component);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var I,M=(I=function(e,t){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),z=function(){return(z=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},A=function(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":D(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;0<=c;c--)(r=e[c])&&(l=(i<3?r(l):3<i?r(t,n,l):r(t,n))||l);return 3<i&&l&&Object.defineProperty(t,n,l),l},N=function(i,l,c,a){return new(c||(c=Promise))(function(e,t){function n(e){try{r(a.next(e))}catch(e){t(e)}}function o(e){try{r(a.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(n,o)}r((a=a.apply(i,l||[])).next())})},Y=function(n,o){var r,i,l,e,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(l=2&t[0]?i.return:t[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,t[1])).done)return l;switch(i=0,l&&(t=[2&t[0],l.value]),t[0]){case 0:case 1:l=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(l=0<(l=c.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3])){c.label=t[1];break}if(6===t[0]&&c.label<l[1]){c.label=l[1],l=t;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(t);break}l[2]&&c.ops.pop(),c.trys.pop();continue}t=o.call(n,c)}catch(e){t=[6,e],i=0}finally{r=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};d.a.locale("zh-cn");var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={self:e},e.realMounted=!1,e.post=new s.a,e.loading=!1,e.container=null,e.commentsDiv=null,e.onComment=function(o,r){return N(e,void 0,void 0,function(){var t,n;return Y(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,a.a.add(o,this.post.id,this.props.store.me,(new Date).getTime())];case 1:return t=e.sent(),this.post.comments.push(t),r.value="",[3,3];case 2:return n=e.sent(),console.error(n),l.a.error(n),[3,3];case 3:return[2]}})})},e}return M(e,t),e.prototype.render=function(){var t=this,e=this.post;return h.a.createElement(c.a,{containerRef:function(e){return t.container=e}},h.a.createElement("div",{className:"post",key:e.id},h.a.createElement("div",null,h.a.createElement("div",{className:"avatar",onClick:function(){return b.Control.go("/user/"+e.accountId)}},h.a.createElement(i.a,{src:e.avatar,shape:"square",size:"large"})),h.a.createElement("div",null,h.a.createElement("div",{onClick:function(){return b.Control.go("/post/"+e.id,{post:e})}},h.a.createElement("span",null,e.title)),h.a.createElement("div",null,h.a.createElement(b.Link,{to:"/user/"+e.accountId},e.username),h.a.createElement("span",null,d()(e.createAt).format("YYYY-MM-DD HH:mm"))))),h.a.createElement("div",null,h.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.content}}),h.a.createElement("div",{onClick:function(){return b.Control.go("/post/"+e.id,{post:e})}})),h.a.createElement("div",null,h.a.createElement("div",null,h.a.createElement(r.a,{type:"caret-up",style:z({marginBottom:"-0.2em",cursor:"pointer"},e.like?{color:"blue"}:{}),onClick:function(){return e.ILike()}}),h.a.createElement("span",null,e.likeCount-e.nayCount),h.a.createElement(r.a,{type:"caret-down",style:z({cursor:"pointer"},e.nay?{color:"red"}:{}),onClick:function(){return e.INay()}})))),h.a.createElement("div",{className:"comments",ref:function(e){return t.commentsDiv=e}},h.a.createElement(E,{onComment:this.onComment}),e.comments.map(function(e){return h.a.createElement(R,{comment:e,key:e.id})})),h.a.createElement(o.a,{spinning:this.loading,size:"large",style:{position:"fixed",top:"50vh",left:"50vw",zIndex:1e3}}))},e.prototype.componentDidMount=function(){this.fetchPost(Number.parseInt(this.props.params.id))},e.prototype.fetchPost=function(r){return N(this,void 0,void 0,function(){var t,n,o=this;return Y(this,function(e){switch(e.label){case 0:return this.loading=!0,-1===(t=this.props.store.posts.findIndex(function(e){return e.id===r}))?[3,2]:(this.post=this.props.store.posts[t],[4,this.post.fetchComments()]);case 1:return e.sent(),[3,4];case 2:return[4,s.a.getPost(r)];case 3:n=e.sent(),Object(u.n)(function(){n.isOk?o.post=n.get("post"):l.a.error(n.get("msg"))}),e.label=4;case 4:return this.loading=!1,this.realMounted=!0,b.Control.state&&b.Control.state.toCommentList&&this.container&&this.container.scrollTo({top:this.commentsDiv.getClientRects().item(0).top}),[2]}})})},e.prototype.componentWillUnmount=function(){this.realMounted=!1},e.getDerivedStateFromProps=function(e,t){if(e.params.id){var n=Number.parseInt(e.params.id);t.self.realMounted&&n!==t.self.post.id&&(t.self.realMounted=!1,t.self.fetchPost(n))}return null},A([u.m],e.prototype,"post",void 0),A([u.m],e.prototype,"loading",void 0),e=A([Object(p.b)("store"),p.c],e)}(h.a.Component);t.default=T}}]);