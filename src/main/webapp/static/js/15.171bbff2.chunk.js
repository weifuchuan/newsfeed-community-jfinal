(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{361:function(e,t,n){"use strict";n(356);var o=n(357),r=(n(373),n(377)),i=n(7),a=n(15),l=n(1),c=n.n(l),s=n(6),u=(n(363),n(3));function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p,d=(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":f(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(a=(i<3?r(a):3<i?r(t,n,a):r(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a},b=function(i,a,l,c){return new(l||(l=Promise))(function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new l(function(e){e(t.value)}).then(n,o)}r((c=c.apply(i,a||[])).next())})},y=function(n,o){var r,i,a,e,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,i=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){l.label=t[1];break}if(6===t[0]&&l.label<a[1]){l.label=a[1],a=t;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(t);break}a[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],i=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.visible=!1,e.logout=function(){return b(e,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Object(i.a)("/logout")];case 1:return e.sent(),window.location.reload(),[2]}})})},e}return d(e,t),e.prototype.render=function(){var t=this;return c.a.createElement("div",{className:"Container",ref:this.props.containerRef},c.a.createElement("div",null,c.a.createElement("div",{className:"navbar"},c.a.createElement("div",null,c.a.createElement("span",{onClick:function(){return s.Control.go("/")}},"随便写的社区")),c.a.createElement("div",null,c.a.createElement(r.a,{placement:"bottomRight",title:c.a.createElement("span",{style:{padding:"0.5em"}},this.props.store.me.username),content:c.a.createElement("div",{className:"my-operations"},c.a.createElement("div",{onClick:function(){return s.Control.go("/my"),t.visible=!1}},c.a.createElement("span",null,"我的主页")),c.a.createElement("div",{onClick:function(){return s.Control.go("/message"),t.visible=!1}},c.a.createElement("span",null,"我的私信")),c.a.createElement("div",{onClick:this.logout},c.a.createElement("span",null,"退出登录"))),trigger:"click",visible:this.visible,onVisibleChange:function(e){return t.visible=e}},c.a.createElement("div",{onClick:function(){return t.visible=!0}},c.a.createElement(o.a,{className:"avatar",shape:"square",size:"large",src:this.props.store.me.avatar}))))),this.props.children))},m([u.m],e.prototype,"visible",void 0),e=m([Object(a.b)("store"),a.c],e)}(c.a.Component);t.a=h},363:function(e,t,n){"use strict";var o=n(364);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(49)(o,r);o.locals&&(e.exports=o.locals)},364:function(e,t,n){(e.exports=n(48)(!1)).push([e.i,".Container {\n  width: 100%;\n  height: 100%;\n  background-color: #EAEAEF;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  overflow: auto; }\n  .Container > div:first-child {\n    padding: 0.5em;\n    position: relative; }\n    @media (max-width: 640px) {\n      .Container > div:first-child {\n        width: 100%; } }\n    @media (min-width: 641px) and (max-width: 1024px) {\n      .Container > div:first-child {\n        width: 80%; } }\n    @media (min-width: 1025px) {\n      .Container > div:first-child {\n        width: 60%; } }\n    .Container > div:first-child .navbar {\n      -webkit-box-shadow: 0px 0px 0.5em #535353;\n              box-shadow: 0px 0px 0.5em #535353;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: justify;\n          -ms-flex-pack: justify;\n              justify-content: space-between;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n      background-color: #fff;\n      border-radius: 0.5em;\n      padding: 1em;\n      margin: 1em 0 1em; }\n      .Container > div:first-child .navbar > div:first-child > span {\n        font-size: 1.5em;\n        font-weight: bold;\n        cursor: pointer; }\n      .Container > div:first-child .navbar > div:nth-child(2) {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex; }\n        .Container > div:first-child .navbar > div:nth-child(2) .avatar {\n          cursor: pointer; }\n\n.my-operations > div {\n  padding: 0.5em;\n  cursor: pointer; }\n\n.my-operations > div:hover {\n  background-color: #EAEAEF; }\n",""])},423:function(e,t,n){"use strict";var o=n(3),i=n(34),a=n(7);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(a=(i<3?r(a):3<i?r(t,n,a):r(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a},s=function(i,a,l,c){return new(l||(l=Promise))(function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new l(function(e){e(t.value)}).then(n,o)}r((c=c.apply(i,a||[])).next())})},u=function(n,o){var r,i,a,e,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,i=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){l.label=t[1];break}if(6===t[0]&&l.label<a[1]){l.label=a[1],a=t;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(t);break}a[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],i=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},r=function(){function r(){this.id=0,this.content="",this.fromId=0,this.toId=0,this.createAt=0}return r.from=function(e){var t=new r;for(var n in e)t[n]=e[n];return t},r.paginate=function(n,o){return void 0===o&&(o=1),s(this,void 0,Promise,function(){var t;return u(this,function(e){switch(e.label){case 0:return[4,Object(a.c)("/message",{toId:n,p:o})];case 1:return[2,{messages:(t=e.sent().data).messages.map(r.from),totalPage:t.totalPage,pageNumber:t.pageNumber}]}})})},r.send=function(n,o,r){return s(this,void 0,Promise,function(){var t;return u(this,function(e){switch(e.label){case 0:return[4,Object(a.c)("/message/send",{toId:n,content:o,createAt:r})];case 1:return"ok"===(t=e.sent().data).state?[2,i.a.ok().set("id",t.id)]:[2,i.a.fail().set("msg","发送失败")]}})})},r.list=function(){return s(this,void 0,Promise,function(){var t;return u(this,function(e){switch(e.label){case 0:return[4,Object(a.a)("/message/list")];case 1:if("ok"===(t=e.sent().data).state)return[2,i.a.ok().set("list",t.list.map(r.from))];throw"error"}})})},l([o.m],r.prototype,"id",void 0),l([o.m],r.prototype,"content",void 0),l([o.m],r.prototype,"fromId",void 0),l([o.m],r.prototype,"toId",void 0),l([o.m],r.prototype,"createAt",void 0),l([o.m],r.prototype,"username",void 0),l([o.m],r.prototype,"avatar",void 0),r}();t.a=r},571:function(e,t,n){var o=n(572);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(49)(o,r);o.locals&&(e.exports=o.locals)},572:function(e,t,n){(e.exports=n(48)(!1)).push([e.i,".MessageContainer {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  padding: 1em;\n  -webkit-box-shadow: 0px 0px 0.5em #535353;\n          box-shadow: 0px 0px 0.5em #535353;\n  background-color: #fff;\n  border-radius: 0.5em;\n  padding: 1em;\n  margin: 0 0 1em; }\n  .MessageContainer .item {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n    cursor: pointer; }\n    .MessageContainer .item > :nth-child(1) {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: justify;\n          -ms-flex-pack: justify;\n              justify-content: space-between;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n      margin-bottom: 1em; }\n      .MessageContainer .item > :nth-child(1) > :nth-child(1) {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center; }\n        .MessageContainer .item > :nth-child(1) > :nth-child(1) > :nth-child(2) {\n          margin-left: 0.5em; }\n  .MessageContainer .item:hover {\n    background-color: #EAEAEF; }\n\n.operationBtns {\n  position: fixed;\n  right: 2em;\n  bottom: 2em;\n  z-index: 100;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column; }\n",""])},694:function(e,t,n){"use strict";n.r(t);n(241);var o=n(77),r=(n(355),n(360)),i=(n(356),n(357)),a=n(1),l=n.n(a),c=(n(571),n(15)),s=n(361),u=n(3),f=n(423),p=n(0),d=n.n(p),m=n(6);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var y,h=(y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),v=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===("undefined"==typeof Reflect?"undefined":b(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(a=(i<3?r(a):3<i?r(t,n,a):r(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a},g=function(i,a,l,c){return new(l||(l=Promise))(function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new l(function(e){e(t.value)}).then(n,o)}r((c=c.apply(i,a||[])).next())})},x=function(n,o){var r,i,a,e,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,i=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){l.label=t[1];break}if(6===t[0]&&l.label<a[1]){l.label=a[1],a=t;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(t);break}a[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],i=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};d.a.locale("zh-cn");var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.messages=[],e.loading=!1,e.fetch=function(){return g(e,void 0,void 0,function(){var t,n,o=this;return x(this,function(e){switch(e.label){case 0:return this.loading=!0,n=u.m,[4,f.a.list()];case 1:return t=n.apply(void 0,[e.sent().get("list")]),Object(u.n)(function(){o.loading=!1,o.messages=t}),this.container.scrollTo({top:0}),[2]}})})},e}return h(e,t),e.prototype.render=function(){var n=this;return l.a.createElement(s.a,{containerRef:function(e){return n.container=e}},l.a.createElement("div",{className:"MessageContainer"},l.a.createElement("h3",{style:{fontSize:"1.5em",textAlign:"center",verticalAlign:"center"}},"我的私信列表"),l.a.createElement("div",{style:{borderTop:"solid #aaa 1px",margin:"1em 0"}}),this.messages.map(function(e,t){return l.a.createElement(l.a.Fragment,{key:t},l.a.createElement("div",{className:"item",onClick:function(){return m.Control.go("/send-message/"+(e.fromId===n.props.store.me.id?e.toId:e.fromId))}},l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement(i.a,{size:"default",src:e.avatar,shape:"square"}),l.a.createElement("span",{style:{fontWeight:"bold",fontSize:"1.2em"}},e.username)),l.a.createElement("span",null,d()(e.createAt).format("YYYY-MM-DD HH:mm"))),l.a.createElement("div",{style:{fontSize:"1.5em"},dangerouslySetInnerHTML:{__html:e.content}})),t===n.messages.length-1?null:l.a.createElement("div",{style:{borderTop:"solid #aaa 1px",margin:"1em 0"}}))}),l.a.createElement("div",{style:{borderTop:"solid #aaa 1px",margin:"1em 0"}})),l.a.createElement("div",{className:"operationBtns"},l.a.createElement(r.a,{type:"primary",shape:"circle",icon:"reload",size:"large",onClick:this.fetch})),l.a.createElement(o.a,{spinning:this.loading,size:"large",style:{position:"fixed",top:"50vh",left:"50vw",zIndex:1e3}}))},e.prototype.componentDidMount=function(){this.fetch()},v([u.m],e.prototype,"messages",void 0),v([u.m],e.prototype,"loading",void 0),e=v([Object(c.b)("store"),c.c],e)}(l.a.Component);t.default=w}}]);